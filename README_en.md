<h1 align="center">Welcome to ZephyrMonitor üëãüèº</h1> 

<h4 align="center">

[ÁÆÄ‰Ωì‰∏≠Êñá](https://github.com/ZephyrAndMoon/zephyr-monitor/blob/master/README.md) &#124; English

</h4>



<br/>
A front-end monitoring tool that includes functions such as monitoring errors, monitoring first screen performance, collecting device information and monitoring network status.

- Collects and reports errors generated by the front-end and supports the capture of cross-domain Javascript file errors.

  > E.g. JavaScript, Promise, Resource, Vue type errors

- Support for reporting first screen performance and loading status of page resources, calculating data on multiple key performance nodes for page performance optimisation reference.

  > E.g. First byte, first interactable time, page load completion time, time taken to parse dom tree...

- Provide device information for the runtime environment based on the above functions.

  > E.g. Model, network environment, browser information, resolution...

- Support for reporting `console` custom type output messages.

- Support for reporting the current page speed at custom intervals.

> The error message can be reported to the server and the stack information can be parsed with [sourcemap](https://github.com/mozilla/source-map) to locate the error in the original file, making it easier to resolve the error in the project.
>
> See specific examples of useÔºö[zephyr-monitor-use-demo](https://github.com/ZephyrAndMoon/zephyr-monitor-use-demo)

<br />

## ‚öôÔ∏è Install or Build

### NPM

```
npm install zephyr-monitor
```

### Build

```shell
git clone git@github.com:ZephyrAndMoon/zephyr-monitor.git

npm install / cnpm install / yarn install

npm run build
# The packaged file will be output as: dist/ZephyrMonitor.min.js 
```

<br />

## üîó Import

```html
<!-- <script> import -->
<script src="ZephyrMonitor.min.js"></script>
```

```javascript
// ES module
import ZephyrMonitor from "zephyr-monitor";

// CommonJS
const ZephyrMonitor = require("zephyr-monitor");
```

<br />

## üìñ Usage

```javascript
// Error monitoring initialization
ZephyrMonitor.initError({
    pageId:"",    // Page ID
    url:"",       // report url
});


// Page performance monitoring initialization
ZephyrMonitor.initPerformance({
    pageId:"",    // Page ID
    url:"",       // report url
    useNetworkSpeed:true, // Timed interval reporting of network speed, default false
});
```

<br />

## üí° Method parameters

### ZephyrMonitor.initError

- **pageId**

  `StringÔºàrequireÔºâ`

  Page ID

- **url**

  `StringÔºàrequireÔºâ`

  Report url

- **reportMethod**

  `Object`

  Reporting method, default XHR upload ÔºàIf more than one sub-parameter is passed in, the default order is Img - Fetch - Beacon - XHRÔºâ

  - `reportMethod.useImg: Boolean`  default `false`Ôºåupload using Img tags
  - `reportMethod.useFetch: Boolean`  default `false`Ôºåupload using the Fetch method
  - `reportMethod.useBeacon: Boolean`  default `false`Ôºåupload using the Beacon method

- **error**

  `Object`

  Error types to catch, default JavaScript type„ÄÅ resource type„ÄÅ Promise type errors

  - `error.vue: Boolean`  default `false`Ôºåcatching Vue type errors
  - `error.console: Boolean`  default `false`Ôºåcapture printout type log
  - `error.js: Boolean`  default `true`Ôºåcatching Javascript type errors
  - `error.resource: Boolean`  default `true`Ôºåcatching resource load type errors
  - `error.promise: Boolean`  default `true`Ôºåcatching Promise type errors

- **vue**

  `Vue`

  Vue instances to be passed in when enabling Vue type error catching

- **extendsInfo**

  `String`

  Customised extension information



### ZephyrMonitor.initPerformance

- **pageId**

  `StringÔºàrequireÔºâ`

  Page ID

- **url**

  `StringÔºàrequireÔºâ`

  Report url

- **useCrossorigin**

  `Boolean`

  Positioning of error messages for error reporting in cross-domain JavaScript files

- **usePerf**

  `Boolean`

  Enable page performance monitoring, default `true`

- **useResource**

  `Boolean`

  Enable resource load monitoring, default `true`

- **usefulResourceType**

  `Object`

  The monitored resource type, default `script/css/fetch/xmlhttprequest/link/img`

  - `usefulResourceType.useRScript: Boolean`  default `false`Ôºåmonitoring the loading of `script` tag type resources
  - `usefulResourceType.useRCSS: Boolean`  default `false`Ôºåmonitoring the loading of `css` tag type resources
  - `usefulResourceType.useRLink: Boolean`  default `false`Ôºåmonitoring the loading of `link` tag type resources
  - `usefulResourceType.useRImg: Boolean`  default `false`Ôºåmonitoring the loading of `Img` tag type resources
  - `usefulResourceType.useRFetch: Boolean`  default `false`Ôºåmonitoring the loading of resources fetched by `Fetch`
  - `usefulResourceType.useRXHR: Boolean`  default `false`Ôºåmonitoring the loading of resources fetched by `XHR`

- **reportMethod**

  `Object`

  Same as in `FrontEndMonitor.initError`

- **useNetworkSpeed**

  `Boolean`

  Enable timed speed information reporting, default `false`, interval is `60s`

- **timeInterval**

  `Number`

  Interval for reporting network speed information

<br />

## üîé ‰∏äÊä•‰ø°ÊÅØÂèÇÊï∞

### ÈîôËØØ‰ø°ÊÅØÂØπË±°

```javascript
{
    pageId: String,        // Page ID
    time: String,          // The time when the error occurred
    category: String,      // Type of error
    logType: String,       // Type of information
    logInfo: {				    
        url: String,       // The url where the error occurred
        stack: String,     // Error stack(unanalysed)
        errorInfo: String, // Error message
        otherInfo: Object  // Other information
    },
    deviceInfo: Object,    // Device information, as described under "Equipment information objects" below
    extendsInfo: Object    // Customised extension information
}
```

### È°µÈù¢ÊÄßËÉΩ‰ø°ÊÅØÂØπË±°

```javascript
{
    pageId: String,                   // Page ID
    time: String,                     // The time when the error occurred
    markUser: String,                 // User identification
    markUv: String,                   // Unique Visitor
    deviceInfo: Object,               // Device information, as described under "Equipment information objects" below
    performance: {
       analysisTime: String,          // Time consumed by parsing dom trees
        blankTime: String,            // Time consumed by white screen
        dnsCacheTime: String,         // Time consumed by DNS query cache
        dnsTime: String,              // Time consumed by DNS query
        domReadyTime: String,         // Time consumed for dom loading to complete
        firstInteractTime: String,    // Time consumed for the first interactable
        pageLoadedTime: String,       // Time consumed for page load completion
        redirectTime: String,         // Time consumed by redirects
        resTime: String,              // Time consumed by data transfer
        tcpTime: String,              // Time consumed by tcp connections
        ttfbTime: String,             // First Byte Duration
        unloadTime: String,           // Time consumed to unload the page
    },
    resource:[
        {
            dnsTime: String,          // Time consumed by DNS query
            initiatorType: String,    // Type of resource requested
            name: String,             // The path to the requested resource or the name of the resource
            nextHopProtocol: String,  // http protocol version
            redirectTime: String,     // Time consumed by redirects
            reqTotalTime: String,     // Time consumed by requests and responses
            responseTime: String,     // Time consumed to receive a response
            tcpTime: String,          // Time consumed by tcp connections
            ttfbTime: String,         // First Byte Duration
        }
   ]
}
```


### ÁΩëÈÄü‰ø°ÊÅØÂØπË±°

```javascript
{
  pageId: String,        // Page ID
  time: String,          // Record time
  category: String,      // Type of log
  logType: String,       // Type of information
  networkSpeed: String,  // Network speed
  deviceInfo: Object,    // Device information, as described under "Equipment information objects" below
  extendsInfo: Object    // Customised extension information
}
```

### ËÆæÂ§á‰ø°ÊÅØÂØπË±°

```javascript
{
    deviceType: String,        // Type of device
    browserInfo: {
        name: String,          // Browser name
        version: String,       // Browser version
    },
    engineInfo: {
        name: String,          // Engine name
        version: String,       // Engine version
    },
    deviceInfo: {
        identified: Boolean,   // Identification status of device information
        manufacturer: String,  // Device manufacturers
        model: String,         // model
        type: String,          // Type of device
    },
    OSInfo:{
        name: String,          // OS name
        version: String,       // OS version
    },
    fingerprint: String,       // Browser fingerprint
    language: String,          // Current language
    netWork: String,           // Network Status
    orientation: String,       // Horizontal and vertical screen status
    screenHeight: Number,      // Height of device
    screenWidth: Number,       // Width of device
    userAgent: String          // User Agent
```


